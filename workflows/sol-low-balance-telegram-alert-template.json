{
  "name": "SOL Low Balance Telegram Alert Template",
  "nodes": [
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "walletAddress",
              "value": "AFK_CRYPTO_WALLET"
            },
            {
              "name": "chain",
              "value": "solana-testnet"
            }
          ],
          "number": [
            {
              "name": "lowBalanceThreshold",
              "value": 100000000
            }
          ]
        },
        "options": {}
      },
      "name": "Set Alert Parameters",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        -1040,
        272
      ],
      "id": "2ef29526-805b-4968-b5ce-3ceef26a796d",
      "notes": "Define the wallet to monitor and the low balance threshold in Lamports.\n100,000,000 = 0.1 SOL"
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.balances[0].raw }}",
              "value2": "={{ $('Set Alert Parameters').item.json.lowBalanceThreshold }}"
            }
          ]
        }
      },
      "name": "Balance < Threshold?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -608,
        272
      ],
      "id": "b78d260b-f4b7-488b-aca4-3d945225f4ad"
    },
    {
      "parameters": {
        "chatId": "5818731857",
        "text": "=⚠️ **Low Balance Alert** ⚠️\n\nThe balance of your wallet `{{ $('Set Alert Parameters').item.json.walletAddress.substring(0, 4) }}...{{ $('Set Alert Parameters').item.json.walletAddress.slice(-4) }}` is critically low!\n\n**Current Balance:** {{ $json[0].amount / 1000000000 }} SOL",
        "additionalFields": {}
      },
      "name": "Send Low Balance Alert",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        -384,
        160
      ],
      "id": "e5a3ecf9-587d-4535-a54d-9a472bc50ebe",
      "webhookId": "9dd3c6d2-efc0-4b21-98cf-e40186992647",
      "credentials": {
        "telegramApi": {
          "id": "P5PVPL3oGa7q3l59",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "url": "https://app.afkcrypto.com/api/v1/wallets/balances",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "chain",
              "value": "={{ $('Set Alert Parameters').item.json.chain }}"
            },
            {
              "name": "address",
              "value": "={{ $('Set Alert Parameters').item.json.walletAddress }}"
            }
          ]
        },
        "options": {}
      },
      "name": "Get Wallet Balance via AFK",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        -832,
        272
      ],
      "id": "40aec1bd-9b5f-44d7-aba2-de793fcfa609",
      "credentials": {
        "httpHeaderAuth": {
          "id": "TELEGRAM_CHAT_ID",
          "name": "n8n-1"
        }
      },
      "notes": "Gets the wallet balance using the AFK Crypto API."
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1264,
        272
      ],
      "id": "361e5bf4-9569-45a2-b579-f54ac8cc89bb",
      "name": "Schedule Trigger"
    }
  ],
  "pinData": {},
  "connections": {
    "Set Alert Parameters": {
      "main": [
        [
          {
            "node": "Get Wallet Balance via AFK",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Balance < Threshold?": {
      "main": [
        [
          {
            "node": "Send Low Balance Alert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Wallet Balance via AFK": {
      "main": [
        [
          {
            "node": "Balance < Threshold?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Set Alert Parameters",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "f4f602ea-093c-4c06-858f-a3f11934e269",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "c4eae34af81eeff658410c97c38d8a485e4c73ba5cea5b25eef189aa5e5a73b9"
  },
  "id": "NXaD1W1g9oZ0wNnV",
  "tags": []
}